# Agenté—®å€™è¯­å“åº”ä¿®å¤è¯´æ˜

## é—®é¢˜æè¿°

ç”¨æˆ·åé¦ˆï¼šå½“ç”¨æˆ·è¯´"ä½ å¥½"æ—¶ï¼ŒAgentç»™å‡ºäº†é”™è¯¯çš„å“åº”ï¼š

```
å…³äºæ‚¨æåˆ°çš„"ä½ å¥½"ï¼Œä»æ³•å¾‹çš„è§’åº¦åˆ†æï¼š

1. é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç¡®è®¤ç›¸å…³çš„åˆè§„è¦æ±‚å’Œé£é™©ç‚¹ã€‚
2. å…¶æ¬¡ï¼Œéœ€è¦è¯„ä¼°å¯¹é¡¹ç›®æ•´ä½“çš„å½±å“ã€‚
3. æœ€åï¼Œå»ºè®®é‡‡å–ç›¸åº”çš„åº”å¯¹æªæ–½ã€‚

è¯·é—®æ‚¨éœ€è¦æˆ‘è¯¦ç»†å±•å¼€å“ªä¸ªæ–¹é¢ï¼Ÿ
```

**é—®é¢˜åˆ†æ**ï¼š
- AgentæŠŠ"ä½ å¥½"å½“æˆäº†ä¸€ä¸ªéœ€è¦åˆ†æçš„é—®é¢˜
- ä½¿ç”¨äº†æ¨¡æ¿åŒ–çš„ä¸“ä¸šåˆ†ææ ¼å¼
- ä¸ç¬¦åˆæ­£å¸¸äº¤æµçš„è¯­å¢ƒ
- ç”¨æˆ·ä½“éªŒå¾ˆå·®

## ä¿®å¤æ–¹æ¡ˆ

### 1. é—®å€™è¯­æ£€æµ‹

åœ¨`generateAgentResponse`å‡½æ•°ä¸­æ·»åŠ é—®å€™è¯­æ£€æµ‹é€»è¾‘ï¼š

```typescript
// é—®å€™è¯­æ£€æµ‹
const greetingPatterns = [
  /^(ä½ å¥½|æ‚¨å¥½|hello|hi|å“ˆå–½|å—¨|æ—©ä¸Šå¥½|ä¸‹åˆå¥½|æ™šä¸Šå¥½|æ™šå®‰)/i,
  /^(è°¢è°¢|æ„Ÿè°¢|æ‹œæ‹œ|å†è§)/i,
  /^(åœ¨å—|åœ¨ä¸åœ¨|æœ‰äººå—)/i
];

const isGreeting = greetingPatterns.some(pattern => pattern.test(question.trim()));
```

### 2. è‡ªç„¶é—®å€™å›å¤

æ·»åŠ å¤šç§è‡ªç„¶çš„é—®å€™å›å¤æ¨¡æ¿ï¼š

```typescript
const greetingResponses = [
  'æ‚¨å¥½ï¼å¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡ã€‚è¯·é—®æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©æ‚¨çš„ï¼Ÿ',
  'æ‚¨å¥½ï¼æˆ‘æ˜¯REITsæ™ºèƒ½åŠ©æ‰‹ï¼Œè¯·é—®æ‚¨æœ‰ä»€ä¹ˆé—®é¢˜éœ€è¦å’¨è¯¢ï¼Ÿ',
  'æ‚¨å¥½ï¼è¯·é—®æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥ä¸ºæ‚¨åšçš„ï¼Ÿ',
  'æ‚¨å¥½ï¼è¯·é—®æ‚¨æƒ³äº†è§£å“ªæ–¹é¢çš„å†…å®¹ï¼Ÿ'
];
```

å½“æ£€æµ‹åˆ°é—®å€™è¯­æ—¶ï¼Œéšæœºè¿”å›ä¸€ä¸ªè‡ªç„¶çš„é—®å€™å›å¤ã€‚

### 3. ç®€çŸ­è¾“å…¥å¤„ç†

å¯¹äºç®€çŸ­çš„è¾“å…¥ï¼ˆå°äº3ä¸ªå­—ç¬¦ï¼‰ï¼Œç»™å‡ºå¼•å¯¼æ€§é—®é¢˜ï¼š

```typescript
if (question.trim().length < 3) {
  return 'æ‚¨å¥½ï¼Œè¯·é—®æ‚¨æœ‰ä»€ä¹ˆå…·ä½“çš„é—®é¢˜éœ€è¦å’¨è¯¢å—ï¼Ÿæˆ‘å¯ä»¥ä¸ºæ‚¨è§£ç­”å…³äºREITså‘è¡Œã€æ³•å¾‹åˆè§„ã€æ”¿ç­–è§£è¯»ã€å°½è°ƒåˆ†æã€å®šä»·å‘è¡Œã€è¿è¥ç®¡ç†ç­‰å„æ–¹é¢çš„é—®é¢˜ã€‚';
}
```

### 4. åä½œAgenté—®å€™è¯­å¤„ç†

ä¸ºåä½œAgentçš„å“åº”ä¹Ÿæ·»åŠ é—®å€™è¯­å¤„ç†ï¼š

```typescript
if (isGreeting) {
  return `æ‚¨å¥½ï¼å¾ˆé«˜å…´å‚ä¸åä½œã€‚è¯·é—®æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©æ‚¨çš„ï¼Ÿ`;
}
```

## ä¿®å¤åçš„æ•ˆæœ

### âœ… é—®å€™è¯­å“åº”

**è¾“å…¥**ï¼šä½ å¥½
**è¾“å‡º**ï¼š
```
æ‚¨å¥½ï¼å¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡ã€‚è¯·é—®æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©æ‚¨çš„ï¼Ÿ
```
æˆ–
```
æ‚¨å¥½ï¼æˆ‘æ˜¯REITsæ™ºèƒ½åŠ©æ‰‹ï¼Œè¯·é—®æ‚¨æœ‰ä»€ä¹ˆé—®é¢˜éœ€è¦å’¨è¯¢ï¼Ÿ
```

**è¾“å…¥**ï¼šæ—©ä¸Šå¥½
**è¾“å‡º**ï¼š
```
æ‚¨å¥½ï¼å¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡ã€‚è¯·é—®æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©æ‚¨çš„ï¼Ÿ
```

**è¾“å…¥**ï¼šè°¢è°¢
**è¾“å‡º**ï¼š
```
æ‚¨å¥½ï¼å¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡ã€‚è¯·é—®æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©æ‚¨çš„ï¼Ÿ
```

### âœ… ç®€çŸ­è¾“å…¥å“åº”

**è¾“å…¥**ï¼šåœ¨å—
**è¾“å‡º**ï¼š
```
æ‚¨å¥½ï¼å¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡ã€‚è¯·é—®æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©æ‚¨çš„ï¼Ÿ
```

**è¾“å…¥**ï¼šæ³•
**è¾“å‡º**ï¼š
```
æ‚¨å¥½ï¼Œè¯·é—®æ‚¨æœ‰ä»€ä¹ˆå…·ä½“çš„é—®é¢˜éœ€è¦å’¨è¯¢å—ï¼Ÿæˆ‘å¯ä»¥ä¸ºæ‚¨è§£ç­”å…³äºREITså‘è¡Œã€æ³•å¾‹åˆè§„ã€æ”¿ç­–è§£è¯»ã€å°½è°ƒåˆ†æã€å®šä»·å‘è¡Œã€è¿è¥ç®¡ç†ç­‰å„æ–¹é¢çš„é—®é¢˜ã€‚
```

### âœ… æ­£å¸¸é—®é¢˜å“åº”

**è¾“å…¥**ï¼šè¿™ä¸ªé¡¹ç›®æœ‰æ³•å¾‹é£é™©å—
**è¾“å‡º**ï¼š
```
å…³äºæ‚¨æåˆ°çš„"è¿™ä¸ªé¡¹ç›®æœ‰æ³•å¾‹é£é™©å—"ï¼Œä»æ³•å¾‹çš„è§’åº¦åˆ†æï¼š

1. é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ç¡®è®¤ç›¸å…³çš„åˆè§„è¦æ±‚å’Œé£é™©ç‚¹ã€‚
2. å…¶æ¬¡ï¼Œéœ€è¦è¯„ä¼°å¯¹é¡¹ç›®æ•´ä½“çš„å½±å“ã€‚
3. æœ€åï¼Œå»ºè®®é‡‡å–ç›¸åº”çš„åº”å¯¹æªæ–½ã€‚

è¯·é—®æ‚¨éœ€è¦æˆ‘è¯¦ç»†å±•å¼€å“ªä¸ªæ–¹é¢ï¼Ÿ
```

## ä»£ç ä¿®æ”¹

### pages/chat/[id].tsx

ä¿®æ”¹äº†ä¸¤ä¸ªå‡½æ•°ï¼š

#### 1. `generateAgentResponse`å‡½æ•°

æ·»åŠ äº†é—®å€™è¯­æ£€æµ‹å’Œè‡ªç„¶å“åº”ï¼š

```typescript
const generateAgentResponse = (
  currentAgent: Agent,
  question: string,
  analysis: any
): string => {
  // é—®å€™è¯­æ£€æµ‹
  const greetingResponses = [
    'æ‚¨å¥½ï¼å¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡ã€‚è¯·é—®æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©æ‚¨çš„ï¼Ÿ',
    'æ‚¨å¥½ï¼æˆ‘æ˜¯REITsæ™ºèƒ½åŠ©æ‰‹ï¼Œè¯·é—®æ‚¨æœ‰ä»€ä¹ˆé—®é¢˜éœ€è¦å’¨è¯¢ï¼Ÿ',
    'æ‚¨å¥½ï¼è¯·é—®æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥ä¸ºæ‚¨åšçš„ï¼Ÿ',
    'æ‚¨å¥½ï¼è¯·é—®æ‚¨æƒ³äº†è§£å“ªæ–¹é¢çš„å†…å®¹ï¼Ÿ'
  ];

  const greetingPatterns = [
    /^(ä½ å¥½|æ‚¨å¥½|hello|hi|å“ˆå–½|å—¨|æ—©ä¸Šå¥½|ä¸‹åˆå¥½|æ™šä¸Šå¥½|æ™šå®‰)/i,
    /^(è°¢è°¢|æ„Ÿè°¢|æ‹œæ‹œ|å†è§)/i,
    /^(åœ¨å—|åœ¨ä¸åœ¨|æœ‰äººå—)/i
  ];

  const isGreeting = greetingPatterns.some(pattern => pattern.test(question.trim()));

  if (isGreeting) {
    const randomResponse = greetingResponses[Math.floor(Math.random() * greetingResponses.length)];
    return randomResponse;
  }

  // æ£€æŸ¥æ˜¯å¦æ˜¯ç®€çŸ­çš„æ— æ„ä¹‰è¾“å…¥
  if (question.trim().length < 3) {
    return 'æ‚¨å¥½ï¼Œè¯·é—®æ‚¨æœ‰ä»€ä¹ˆå…·ä½“çš„é—®é¢˜éœ€è¦å’¨è¯¢å—ï¼Ÿæˆ‘å¯ä»¥ä¸ºæ‚¨è§£ç­”å…³äºREITså‘è¡Œã€æ³•å¾‹åˆè§„ã€æ”¿ç­–è§£è¯»ã€å°½è°ƒåˆ†æã€å®šä»·å‘è¡Œã€è¿è¥ç®¡ç†ç­‰å„æ–¹é¢çš„é—®é¢˜ã€‚';
  }

  // åŸæœ‰çš„ä¸“ä¸šå›ç­”é€»è¾‘...
};
```

#### 2. `generateCollaborationResponse`å‡½æ•°

æ·»åŠ äº†é—®å€™è¯­å¤„ç†ï¼š

```typescript
const generateCollaborationResponse = (
  collaboratingAgent: Agent,
  originalQuestion: string
): string => {
  const greetingPatterns = [
    /^(ä½ å¥½|æ‚¨å¥½|hello|hi|å“ˆå–½|å—¨|æ—©ä¸Šå¥½|ä¸‹åˆå¥½|æ™šä¸Šå¥½|æ™šå®‰)/i,
    /^(è°¢è°¢|æ„Ÿè°¢|æ‹œæ‹œ|å†è§)/i,
    /^(åœ¨å—|åœ¨ä¸åœ¨|æœ‰äººå—)/i
  ];

  const isGreeting = greetingPatterns.some(pattern => pattern.test(originalQuestion.trim()));

  if (isGreeting) {
    return `æ‚¨å¥½ï¼å¾ˆé«˜å…´å‚ä¸åä½œã€‚è¯·é—®æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©æ‚¨çš„ï¼Ÿ`;
  }

  // åŸæœ‰çš„åä½œå›ç­”é€»è¾‘...
};
```

## æµ‹è¯•ç”¨ä¾‹

### æµ‹è¯•ç”¨ä¾‹1ï¼šç®€å•é—®å€™
```
è¾“å…¥ï¼šä½ å¥½
é¢„æœŸï¼šè‡ªç„¶é—®å€™å›å¤
å®é™…ï¼šâœ… é€šè¿‡
```

### æµ‹è¯•ç”¨ä¾‹2ï¼šè‹±æ–‡é—®å€™
```
è¾“å…¥ï¼šHello
é¢„æœŸï¼šè‡ªç„¶é—®å€™å›å¤
å®é™…ï¼šâœ… é€šè¿‡
```

### æµ‹è¯•ç”¨ä¾‹3ï¼šæ—¶é—´é—®å€™
```
è¾“å…¥ï¼šæ—©ä¸Šå¥½
é¢„æœŸï¼šè‡ªç„¶é—®å€™å›å¤
å®é™…ï¼šâœ… é€šè¿‡
```

### æµ‹è¯•ç”¨ä¾‹4ï¼šæ„Ÿè°¢
```
è¾“å…¥ï¼šè°¢è°¢
é¢„æœŸï¼šè‡ªç„¶é—®å€™å›å¤
å®é™…ï¼šâœ… é€šè¿‡
```

### æµ‹è¯•ç”¨ä¾‹5ï¼šç®€çŸ­è¯¢é—®
```
è¾“å…¥ï¼šåœ¨å—
é¢„æœŸï¼šè‡ªç„¶é—®å€™å›å¤
å®é™…ï¼šâœ… é€šè¿‡
```

### æµ‹è¯•ç”¨ä¾‹6ï¼šå•å­—ç¬¦
```
è¾“å…¥ï¼šæ³•
é¢„æœŸï¼šå¼•å¯¼æ€§é—®é¢˜
å®é™…ï¼šâœ… é€šè¿‡
```

### æµ‹è¯•ç”¨ä¾‹7ï¼šæ­£å¸¸é—®é¢˜
```
è¾“å…¥ï¼šè¿™ä¸ªé¡¹ç›®æœ‰æ³•å¾‹é£é™©å—
é¢„æœŸï¼šä¸“ä¸šåˆ†æå›ç­”
å®é™…ï¼šâœ… é€šè¿‡
```

### æµ‹è¯•ç”¨ä¾‹8ï¼šå¤æ‚é—®é¢˜
```
è¾“å…¥ï¼šè¿™ä¸ªREITsé¡¹ç›®çš„èµ„äº§æƒå±ã€æ³•å¾‹é£é™©ã€è´¢åŠ¡çŠ¶å†µå¦‚ä½•ï¼Ÿ
é¢„æœŸï¼šä¸“ä¸šåˆ†æå›ç­”ï¼Œå¯èƒ½è§¦å‘åä½œ
å®é™…ï¼šâœ… é€šè¿‡
```

## ä¼˜åŠ¿

1. **è‡ªç„¶çš„å¯¹è¯ä½“éªŒ**ï¼šé—®å€™è¯­å¾—åˆ°è‡ªç„¶çš„å›åº”ï¼Œä¸å†æ˜¯æœºæ¢°çš„åˆ†æ
2. **å¤šæ ·æ€§**ï¼šå¤šç§é—®å€™å›å¤æ¨¡æ¿ï¼Œé¿å…é‡å¤
3. **å¼•å¯¼æ€§**ï¼šå¯¹ç®€çŸ­è¾“å…¥ç»™å‡ºå¼•å¯¼ï¼Œé¼“åŠ±ç”¨æˆ·æå‡ºå…·ä½“é—®é¢˜
4. **ä¸€è‡´æ€§**ï¼šåä½œAgentä¹Ÿæœ‰ç›¸åŒçš„é—®å€™è¯­å¤„ç†
5. **ç”¨æˆ·å‹å¥½**ï¼šç¬¦åˆäººç±»æ­£å¸¸çš„äº¤æµä¹ æƒ¯

## æœªæ¥æ”¹è¿›

### 1. ä¸Šä¸‹æ–‡æ„ŸçŸ¥
æ ¹æ®å¯¹è¯å†å²è°ƒæ•´é—®å€™å›å¤ï¼š

```typescript
if (isGreeting && messages.length > 2) {
  return 'æ‚¨å¥½ï¼è¯·é—®è¿˜æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©æ‚¨çš„ï¼Ÿ';
}
```

### 2. æ—¶é—´æ„ŸçŸ¥
æ ¹æ®å½“å‰æ—¶é—´è°ƒæ•´é—®å€™ï¼š

```typescript
const hour = new Date().getHours();
if (hour < 12) {
  return 'æ—©ä¸Šå¥½ï¼è¯·é—®æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©æ‚¨çš„ï¼Ÿ';
} else if (hour < 18) {
  return 'ä¸‹åˆå¥½ï¼è¯·é—®æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©æ‚¨çš„ï¼Ÿ';
} else {
  return 'æ™šä¸Šå¥½ï¼è¯·é—®æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©æ‚¨çš„ï¼Ÿ';
}
```

### 3. ä¸ªæ€§åŒ–é—®å€™
æ ¹æ®Agentçš„äººæ ¼ç‰¹è´¨å®šåˆ¶é—®å€™ï¼š

```typescript
if (currentAgent.id === 'legal-risk') {
  return 'æ‚¨å¥½ï¼æˆ‘æ˜¯æ³•åŠ¡é£æ§Agentï¼Œä¸“æ³¨äºREITsæ³•å¾‹åˆè§„ä¸é£é™©ç®¡æ§ã€‚è¯·é—®æ‚¨éœ€è¦å“ªæ–¹é¢çš„æ³•åŠ¡æ”¯æŒï¼Ÿ';
}
```

### 4. è¡¨æƒ…ç¬¦å·æ”¯æŒ
æ·»åŠ é€‚å½“çš„è¡¨æƒ…ç¬¦å·å¢å¼ºäº²å’ŒåŠ›ï¼š

```typescript
return 'æ‚¨å¥½ï¼ğŸ‘‹ å¾ˆé«˜å…´ä¸ºæ‚¨æœåŠ¡ã€‚è¯·é—®æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®åŠ©æ‚¨çš„ï¼Ÿ';
```

## æ€»ç»“

é€šè¿‡æ·»åŠ é—®å€™è¯­æ£€æµ‹å’Œè‡ªç„¶å“åº”æœºåˆ¶ï¼ŒAgentç°åœ¨èƒ½å¤Ÿï¼š
- âœ… æ­£ç¡®è¯†åˆ«é—®å€™è¯­
- âœ… ç»™å‡ºè‡ªç„¶çš„ã€äººæ€§åŒ–çš„å›å¤
- âœ… ç¬¦åˆæ­£å¸¸äº¤æµçš„è¯­å¢ƒ
- âœ… æå‡ç”¨æˆ·ä½“éªŒ
- âœ… ä¿æŒä¸“ä¸šæ€§ï¼ˆé’ˆå¯¹æ­£å¸¸é—®é¢˜ï¼‰

ä¿®å¤åçš„ç³»ç»Ÿæ›´åŠ æ™ºèƒ½å’Œå‹å¥½ï¼Œèƒ½å¤Ÿé€‚åº”ä¸åŒç±»å‹çš„ç”¨æˆ·è¾“å…¥ã€‚
